# MVP 1.0 Design: Personal Finance Dashboard

**Date:** 2026-02-01
**Version:** MVP 1.0
**Scope:** Initial dashboard with PDF statement upload, transaction categorization, and multi-country support

---

## Vision

A comprehensive personal finance platform that becomes the "mission control system" for tracking all financial positions (cash, stocks, ETFs, dividends, pensions) across multiple countries. MVP 1.0 is the foundation that supports you and your wife tracking shared finances with intelligent automation.

**Long-term features (beyond MVP):**
- Live ETF/Stock price tracking
- Automatic index optimization
- Monthly financial position snapshots (net worth tracking)
- Savings habits tracking and feedback
- Budget automation and ETF purchase optimization
- Investment return tracking and breakdowns
- Property/mortgage tracking
- Crypto and managed funds support
- FIRE dashboard and calculator
- Multi-currency international asset support

---

## MVP 1.0 Scope

### Core Features
1. **Dashboard Overview** - Summary cards for current spend, income, savings, investments
2. **Country Toggle** - Switch between UK and India views (separate currency display: GBP/INR)
3. **PDF Statement Upload** - Drag-and-drop bank statement uploads with auto-detection
4. **Transaction Extraction** - LLM-powered extraction of transactions from PDFs with structured output
5. **Transaction Categorization** - Auto-suggested categories with manual override capability
6. **Settings/Ops Page** - Management interface for:
   - Bank account linking and naming
   - Transaction categories (view, edit, add custom)
   - PDF upload and processing

### Currencies
- **UK:** GBP (Pound Sterling)
- **India:** INR (Indian Rupee)
- Exchange rates stored for multi-currency reporting

---

## Architecture

### Tech Stack
- **Backend:** Node.js + Express
- **Database:** PostgreSQL (Railway)
- **Frontend:** HTML/CSS/JS (view layer via Express)
- **LLM Integration:** OpenRouter + Mistral (structured transaction extraction)
- **Testing:** Jest, Supertest, Playwright

### Authentication
- Single shared login (email/password) for both users
- No role-based access control needed for MVP

---

## Database Schema

### Tables

```sql
users
├── id (PK)
├── email (UNIQUE)
├── password_hash
├── created_at, updated_at

countries
├── id (PK)
├── code ('UK', 'IN')
├── name
├── currency_code ('GBP', 'INR')

bank_accounts
├── id (PK)
├── user_id (FK)
├── country_id (FK)
├── bank_name
├── account_type ('checking', 'savings', 'investment')
├── account_number_masked
├── currency
├── confirmed (boolean - user confirmed auto-detection)
├── created_at, updated_at

transaction_categories
├── id (PK)
├── name (UNIQUE)
├── description
├── system_defined (boolean)

transactions
├── id (PK)
├── user_id (FK)
├── bank_account_id (FK)
├── transaction_date
├── amount
├── currency
├── description
├── merchant
├── transaction_type ('debit', 'credit')
├── category_id (FK)
├── pdf_upload_id (FK)
├── created_at, updated_at

pdf_uploads
├── id (PK)
├── user_id (FK)
├── bank_account_id (FK)
├── file_name
├── bank_detected
├── transaction_count
├── upload_status ('pending', 'processed', 'failed')
├── uploaded_at

currency_exchange_rates
├── id (PK)
├── from_currency
├── to_currency
├── rate
├── rate_date
├── created_at
```

---

## Dashboard Layout

### Main Dashboard
```
Header: Logo | Country Selector (UK/India) | Settings | Logout

Summary Cards (4 columns):
├── Current Spend (this month)
├── Current Income (this month)
├── Current Savings (total balance)
└── Investments (total balance)

Recent Transactions (Table):
├── Date | Merchant | Amount | Category
└── [Last 10 transactions]
```

### Settings/Ops Page
```
Sidebar Navigation:
├── Upload PDF
├── Categories
└── Banks

Content Area:
├── Upload PDF: Drag-and-drop, extraction preview, confirmation
├── Categories: List, edit, add custom, toggle active/inactive
└── Banks: List accounts, edit names, add manual accounts
```

---

## PDF Upload & Transaction Extraction Flow

### Step-by-Step Process

1. **User Action:** Navigate to Settings/Ops → Upload PDF
2. **File Selection:** Drag-and-drop or file picker
3. **Backend Processing:**
   - Extract text from PDF using pdf-lib or similar
   - Send to OpenRouter + Mistral with structured prompt
   - Detect bank name and account type
   - Check if account exists in database
4. **Account Confirmation:**
   - If new: Show confirmation dialog ("This looks like Barclays UK Checking. Correct?")
   - If exists: Auto-confirm and proceed
5. **Transaction Preview:**
   - Display extracted transactions with LLM-suggested categories
   - Allow manual category override
   - Show confidence scores
6. **Save:** Import all transactions to database

### LLM Structured Output Format
```json
{
  "transactions": [
    {
      "date": "2024-02-01",
      "amount": "45.50",
      "merchant": "Tesco",
      "description": "Grocery shopping",
      "transaction_type": "debit"
    }
  ],
  "bank_detected": "Barclays",
  "account_type": "checking",
  "confidence": 0.95,
  "extraction_notes": "Clear statement format"
}
```

### Category Assignment
- LLM suggests category based on merchant name and description
- User can override before saving
- System learns from user choices for future suggestions

---

## Seeded Transaction Categories

**Standard Categories (with descriptions):**
- **Groceries:** Food and grocery shopping
- **Utilities:** Water, electricity, gas, internet
- **Transport:** Fuel, public transit, car maintenance
- **Entertainment:** Movies, gaming, hobbies
- **Dining:** Restaurants, cafes, food delivery
- **Healthcare:** Medical, pharmacy, wellness
- **Subscriptions:** Apps, streaming, memberships
- **Salary/Income:** Wages, bonuses, regular income
- **Savings:** Transfers to savings accounts
- **Investments:** Stock, ETF, crypto purchases
- **Insurance:** Health, car, home insurance
- **Shopping:** Clothing, home goods, miscellaneous
- **Fees:** Bank fees, transaction costs

---

## Testing Strategy

### 1. Unit Tests (Jest)
- LLM prompt formatting
- Category assignment logic
- Currency conversion
- Transaction aggregation (spend/income/savings/investments)
- Database query functions

### 2. Integration Tests (Jest + Supertest)
- User authentication (login/logout)
- PDF upload → extraction → database
- Dashboard data aggregation
- Bank account auto-detection
- Category CRUD operations
- Country toggle functionality

### 3. End-to-End Tests (Playwright)
- User login flow
- Dashboard loads with correct data
- PDF upload and transaction extraction
- Settings/Ops page navigation
- Category management
- Bank account management
- Country toggle verification

**Coverage Target:** 70%+ for MVP 1.0

---

## Data Model Considerations

### Multi-Country Support
- All transactions store their country via bank_account_id relationship
- Dashboard filters by selected country (via country_selector in session/state)
- Currency conversions stored in exchange_rates table for reporting

### Month-to-Date Calculations
- Spend: SUM of debit transactions (last 30 days, current country)
- Income: SUM of credit transactions (last 30 days, current country)
- Savings: SUM of balances in 'savings' accounts (current country)
- Investments: SUM of balances in 'investment' accounts (current country)

### Future Extensibility
- Schema supports additional features (snapshots, budgets, dividends, etc.)
- Category system is extensible (AI learns new categories)
- Bank detection can be expanded with more institution support

---

## Implementation Notes

### First Build Session
1. Set up database schema in PostgreSQL
2. Create authentication system (login)
3. Build dashboard with hardcoded/test data
4. Implement PDF upload endpoint
5. Integrate OpenRouter + Mistral
6. Build transaction extraction logic
7. Implement category management UI
8. Add comprehensive tests

### Git Workflow
- Feature branches for each sub-feature
- Pull requests with test coverage validation
- Deployment to Railway after each feature completes

### Environment Setup
- `.env` file contains OpenRouter API keys
- DATABASE_URL from Railway Postgres service
- PORT configuration for local dev

---

## Success Criteria

- ✅ Dashboard displays correct summary cards for selected country
- ✅ PDF upload successfully extracts transactions from statements
- ✅ Transactions are categorized automatically with LLM
- ✅ User can manually override categories
- ✅ Bank accounts are auto-detected and confirmed
- ✅ Settings/Ops page fully functional (upload, categories, banks)
- ✅ Country toggle switches data correctly
- ✅ 70%+ test coverage
- ✅ E2E tests pass for main user flows

---

## Next Steps

1. ✅ Design finalized and documented
2. Create feature branches for:
   - User authentication
   - Database schema setup
   - Dashboard UI
   - PDF upload and extraction
   - Settings/Ops management
3. Implement each feature with tests
4. Integration testing
5. Deployment to Railway
